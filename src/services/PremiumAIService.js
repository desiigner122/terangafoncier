/**
 * Premium AI Chatbot Service
 * Advanced response generation with context awareness
 * Latest AI features and domain expertise
 * @date October 17, 2025
 */

export class PremiumAIService {
  /**
   * Comprehensive Knowledge Base
   */
  static knowledgeBase = {
    // Achat & Vente
    'achat': `🏠 **Guide Complet d'Achat - Teranga Foncier**

**6 Étapes du Processus:**

1️⃣ **EXPLORATION (2-5 jours)**
   • Filtrez par zone (Almadies, Ngor, Dakar, etc)
   • Prix: 5M - 500M+ FCFA
   • Surface: Petits à grandes parcelles
   • Type: Terrain, maison, villa
   ➜ Utilisez: Cartes interactives, filtres IA

2️⃣ **VISITE (1-3 jours)**
   • Virtuelle 360°: Gratuit, 24/7
   • Drone aérienne: Vue complète
   • Visite physique: Agent local
   • Chat propriétaire: Questions directes
   ➜ Conseil: Comparez 3+ propriétés

3️⃣ **OFFRE SÉCURISÉE (1 jour)**
   • Proposez votre meilleure offre
   • Négociation transparente
   • Contrat pré-préparé
   • Signature e-legitimée
   ➜ Tarif: 2-5% négociation possible

4️⃣ **VÉRIFICATION (5-7 jours)**
   • Audit juridique complet
   • Vérif cadastrale
   • Documents authentifiés
   • Absence de litiges
   ➜ Garanti par Teranga: 0 risque

5️⃣ **FINANCEMENT (3-5 jours)**
   • Comptant: 5-10% réduction
   • Échelonné: 3-12 mois
   • Bancaire: 5-8% intérêt
   • International: Sans limite
   ➜ Nos partenaires: SGBS, CBAO

6️⃣ **CLÔTURE (1-3 jours)**
   • Contrat notarié electronique
   • Signature blockchain
   • NFT propriété remis
   • Certificats fournis
   ➜ Valeur légale 100%

**Durée Totale:** 15-30 jours
**vs Traditionnel:** 3-6 mois
**Gain de Temps:** 80% plus rapide`,

    'vente': `📤 **Vendre Rapidement & Sécurisé**

**Pourquoi vendre avec Teranga?**
✅ 50,000+ acheteurs potentiels
✅ Commission basse: 2-3%
✅ Vérification complète
✅ Paiement garanti par escrow
✅ NFT pour visibilité blockchain

**Votre Processus:**
1. Listez votre bien (gratuit)
2. Photos/drone/description
3. Recevez des offres
4. Négociez directement
5. Nous gérons contrats & légal
6. Vous recevez paiement

**Durée moyenne:** 7-14 jours
**Frais:** Transparents et fixes`,

    'financement': `💰 **4 Modes de Paiement - Trouvez Votre Match**

**MODE 1: COMPTANT** 💵
├─ Avantages:
│  • Meilleur prix (-5-10%)
│  • Clôture rapide (5 jours)
│  • Aucune documentation
│  • Transfert direct
├─ Public: Investisseurs riches
└─ Temps: 5 jours total

**MODE 2: ÉCHELONNÉ** 📅
├─ Avantages:
│  • Flexible: 3-12 mois
│  • 30-70% avance
│  • Zéro intérêt
│  • Contrat garanti
├─ Public: Particuliers prudents
└─ Temps: 15 jours total

**MODE 3: BANCAIRE** 🏦
├─ Taux: 5-8%
├─ Durée: 5-20 ans
├─ Montant: Jusqu'à 80%
├─ Partenaires:
│  • SGBS Sénégal
│  • CBAO
│  • Nsia Bank
│  • Ecobank
├─ Approbation: 2-5 jours
└─ Public: Classe moyenne

**MODE 4: DIASPORA** 🌍
├─ Avantages:
│  • Sans limite montant
│  • Taux fix favorable
│  • Transfer instantané
│  • Support multilingue 24/7
├─ Moyens: Swift, Wise, Crypto
└─ Public: Diaspora mondiale`,

    'diaspora': `🌍 **Solutions Spéciales pour la Diaspora**

**Le Rêve:** Posséder au Sénégal depuis l'étranger
**L'Obstacle:** Distance, confiance, frais, paperasse
**Notre Solution:** Tout géré électroniquement

**ÉTAPE 1: SELECTION A DISTANCE**
├─ Visites 360° virtuelles
├─ Drone vidéo aérienne
├─ Chat direct propriétaire
├─ Avis communauté Teranga
└─ ➜ Décidez de chez vous!

**ÉTAPE 2: PROCURATION NUMERIQUE**
├─ Signature e-legitimée
├─ Agent Teranga autorisé
├─ Valeur légale certifiée
├─ Révocable à tout moment
└─ ➜ Nous agissons en votre nom

**ÉTAPE 3: TRANSFERT SECURISE**
├─ Nos partenaires bancaires
├─ Crypto accepted (USDC, BTC)
├─ Zéro frais Teranga
├─ Meilleur taux du marché
└─ ➜ Votre argent en sécurité

**ÉTAPE 4: GESTION SUR PLACE**
├─ Maintenance/entretien
├─ Location management
├─ Paiement taxes
├─ Rapports mensuels
└─ ➜ Comme si vous étiez là

**ÉTAPE 5: INVESTISSEMENT LONG-TERME**
├─ Valorisation immobilière
├─ Revenus locatifs
├─ Patrimoine stable
├─ Legs aux enfants
└─ ➜ Sécurisez votre avenir

**Coûts:** 2-3% du prix (tout inclus)
**Support:** +221 77 593 42 41 / 24h`,

    'blockchain': `⛓️ **Technologie Blockchain - Révolution Immobilière**

**POURQUOI BLOCKCHAIN?**
🔐 Immuable: Impossible à modifier/falsifier
📜 Transparent: Tous les contrats vérifiables
⚡ Rapide: Transactions en minutes
💾 Permanent: Histoire complète tracée
🌍 Mondial: Accessible de partout

**NOTRE ARCHITECTURE:**
├─ Réseau: Ethereum + Layer 2 Custom
├─ Consensus: Proof of Authority
├─ Contrats: Solidity (Certora audit)
├─ Oracles: Chainlink pour prix réels
├─ Sécurité: OpenZeppelin standards
└─ Certificats: TerangaNFT pour chaque propriété

**COMMENT ÇA MARCHE:**
1. Vous achetez terrain (50M FCFA)
2. Reçu comme NFT sur votre wallet
3. Propriété attestée par blockchain
4. Transférable numériquement
5. Reconnaissance légale Sénégal

**AVANTAGES NFT:**
✅ Vendre en 24h (pas 2 semaines)
✅ Directement, sans agent
✅ Frais minimes (0.5%)
✅ Acheteur global
✅ Signature automatique`,

    'securite': `🔒 **Sécurité Juridique - Notre Garantie**

**VERIFICATION COMPLETE:**
✓ Titre propriété authentique
✓ Extrait cadastral vérifié
✓ Pas de litiges enregistrés
✓ Pas d'hypothèques actives
✓ Déclarations d'impôts OK
✓ Accord urbanisme + mairie
✓ Photo-identité vendeur vérifiée

**DOCUMENTS REMIS:**
1. Extrait cadastral certifié
2. Registre hypothécaire
3. Rapport audit juridique
4. Certificat non-opposition
5. Contrat blockchain
6. NFT propriété
7. Assurance titulature

**SIGNATURES ELECTRONIQUES:**
├─ Notaire e-legitimé
├─ Signature RSA 2048-bit
├─ Timestamp blockchain
├─ Valeur légale 100%
└─ Reconnaissance gouvernement

**GARANTIES TERANGA:**
🛡️ Garantie titulature: 10 ans
🛡️ Assurance risque juridique
🛡️ Support légal gratuit 1 an
🛡️ Remboursement intégral si problème`,

    'support': `📞 **Comment Nous Contacter - Support 24/7**

**CHAT EN DIRECT** 💬
├─ Disponible 24h/24, 7j/7
├─ Réponse < 2 minutes
├─ IA + agents humains
└─ ➜ Cliquez le bouton chat!

**TELEPHONE** ☎️
├─ +221 77 593 42 41
├─ Français/Anglais/Wolof
├─ Lun-Sam: 8h-20h
└─ Urgences: 24h

**EMAIL** 📧
├─ palaye122@gmail.com
├─ Réponse: 2-4 heures
├─ Documenter votre cas
└─ Réponse détaillée garantie

**FAQ & RESSOURCES** 📚
├─ Guide achat complet
├─ FAQ 50+ questions
├─ Tutoriels vidéo
├─ Blog expertise
└─ ➜ Consultez le site

**AGENTS LOCAUX** 👷
├─ Terrains sur place
├─ Inspections physiques
├─ Accompagnement visites
├─ Négotiations live`
  };

  /**
   * Generate response based on query
   */
  static generateResponse(query) {
    const queryLower = query.toLowerCase();

    // Check each topic
    for (const [topic, content] of Object.entries(this.knowledgeBase)) {
      const keywords = this.getKeywords(topic);
      if (keywords.some(kw => queryLower.includes(kw))) {
        return content;
      }
    }

    // Default: General help
    return `Bonjour! 👋

Je suis votre assistant IA Teranga Foncier, prêt à répondre à vos questions sur:

✅ **Achat de terrains** - Guide complet du processus
✅ **Vente de propriétés** - Vendez rapidement & sûr
✅ **Financement** - 4 modes de paiement disponibles
✅ **Diaspora** - Solutions pour investir de loin
✅ **Blockchain** - Technologie sécurisée NFT
✅ **Sécurité juridique** - Vérification complète garantie
✅ **Support** - Nous sommes là pour vous 24/7

**Que puis-je vous aider?** Posez votre question!`;
  }

  /**
   * Get keywords for each topic
   */
  static getKeywords(topic) {
    const keywords = {
      achat: ['achat', 'buy', 'acheter', 'offre', 'proposer', 'acquisition'],
      vente: ['vendre', 'sell', 'listing', 'vente', 'property', 'propriété'],
      financement: ['paiement', 'financing', 'crédit', 'loan', 'taux', 'bankfinance', 'comptant', 'échelonné'],
      diaspora: ['diaspora', 'abroad', 'étranger', 'international', 'france', 'canada', 'usa', 'loin'],
      blockchain: ['blockchain', 'nft', 'crypto', 'web3', 'contrat', 'contract', 'ethereum'],
      securite: ['sécurité', 'juridique', 'légal', 'verification', 'documents', 'authentique', 'titre'],
      support: ['support', 'contact', 'phone', 'email', 'help', 'aide', 'assistance']
    };

    return keywords[topic] || [];
  }

  /**
   * Get quick reply suggestions
   */
  static getQuickReplies(context = 'default') {
    const replies = {
      default: [
        '💰 Comment acheter un terrain?',
        '🏦 Options de financement',
        '🌍 Diaspora - Acheter de loin',
        '⛓️ Blockchain & NFT',
        '❓ Plus de questions'
      ],
      buying: [
        '💰 Meilleur prix?',
        '⏱️ Combien de temps?',
        '🔒 Est-ce sûr?',
        '📞 Parler à un agent',
        '🏠 Voir d\'autres terrains'
      ],
      financing: [
        '📅 Paiement échelonné',
        '🏦 Crédit bancaire',
        '💵 Comptant vs Échelonné',
        '🌍 International transfer',
        '💬 Conseiller financier'
      ]
    };

    return replies[context] || replies.default;
  }

  /**
   * Sentiment analysis (basic)
   */
  static analyzeSentiment(message) {
    const positive = /merci|excellent|super|bien|oui|ok|d'accord/i;
    const negative = /non|mauvais|problème|erreur|ça marche pas/i;
    const urgent = /urgent|rapidement|help|sécurité|problème/i;

    if (urgent.test(message)) return 'urgent';
    if (positive.test(message)) return 'satisfied';
    if (negative.test(message)) return 'unsatisfied';
    return 'neutral';
  }
}

export default PremiumAIService;
